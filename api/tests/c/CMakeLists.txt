cmake_minimum_required(VERSION 3.6)

project(indigo-tests LANGUAGES C CXX)

if (ENABLE_TESTS)
    add_executable(${PROJECT_NAME}-dlopen ${CMAKE_CURRENT_SOURCE_DIR}/indigo-test-dlopen.c)
    target_link_libraries(${PROJECT_NAME}-dlopen ${CMAKE_DL_LIBS})
    add_test(NAME ${PROJECT_NAME}-dlopen-indigo COMMAND ${PROJECT_NAME}-dlopen ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo.so)
    if(BUILD_INDIGO_INCHI)
        add_test(NAME ${PROJECT_NAME}-dlopen-indigo-inchi COMMAND ${PROJECT_NAME}-dlopen ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo.so ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo-inchi.so)
    endif()
    if (BUILD_INDIGO_RENDERER)
        add_test(NAME ${PROJECT_NAME}-dlopen-indigo-renderer COMMAND ${PROJECT_NAME}-dlopen ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo.so ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo-renderer.so)
    endif()
    if (BUILD_BINGO_NOSQL)
        add_test(NAME ${PROJECT_NAME}-dlopen-bingo-nosql COMMAND ${PROJECT_NAME}-dlopen ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libindigo.so ${CMAKE_LIBRARY_OUTPUT_DIRECTORY}/libbingo-nosql.so)
    endif()
endif()
